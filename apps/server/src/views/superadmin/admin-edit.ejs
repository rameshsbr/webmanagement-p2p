<% layout('superadmin/layout') -%>

<% if (typeof saved !== 'undefined' && saved) { %>
  <div class="alert success" style="margin-bottom:16px;">Saved.</div>
<% } %>

<form method="post" action="<%= admin ? '/superadmin/admins/'+admin.id+'/edit' : '/superadmin/admins/new' %>" class="card">
  <div class="f-item">
    <label>Email</label>
    <input name="email" type="email" value="<%= admin?.email||'' %>" required/>
  </div>

  <div class="f-item">
    <label>Password <small>(leave blank to keep)</small></label>
    <div class="row" style="gap:8px; align-items:center;">
      <input id="pw1" name="password" type="password" autocomplete="new-password" />
      <button type="button" class="btn small" id="togglePw1">Show</button>
    </div>
  </div>

  <div class="f-item">
    <label>Confirm password</label>
    <div class="row" style="gap:8px; align-items:center;">
      <input id="pw2" name="confirm" type="password" autocomplete="new-password" />
      <button type="button" class="btn small" id="togglePw2">Show</button>
    </div>
  </div>

  <div class="f-item">
    <label>Role</label>
    <select name="role">
      <option value="ADMIN" <%= admin?.role==='ADMIN'?'selected':'' %>>ADMIN</option>
      <option value="SUPER" <%= admin?.role==='SUPER'?'selected':'' %>>SUPER</option>
      <option value="SUPPORT" <%= admin?.role==='SUPPORT'?'selected':'' %>>SUPPORT</option>
    </select>
  </div>

  <div class="f-item">
    <label class="row" style="gap:8px; align-items:center;">
      <input type="checkbox" name="active" <%= admin ? (admin.active ? 'checked' : '') : 'checked' %> />
      <span>Active â€” can sign in</span>
    </label>
  </div>

  <div class="row"><button class="btn primary">Save</button></div>
</form>

<script>
(function(){
  function toggle(id, btnId){
    var input = document.getElementById(id);
    var btn = document.getElementById(btnId);
    if (!input || !btn) return;
    btn.addEventListener('click', function(e){
      e.preventDefault();
      var to = input.type === 'password' ? 'text' : 'password';
      try { input.type = to; } catch(_){}
      btn.textContent = (to === 'text') ? 'Hide' : 'Show';
      try { input.focus(); } catch(_){}
    });
  }
  toggle('pw1','togglePw1');
  toggle('pw2','togglePw2');
})();
</script>